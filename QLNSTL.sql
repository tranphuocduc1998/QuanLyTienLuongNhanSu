--USE master
--DROP DATABASE QLNSTL

CREATE DATABASE QLNSTL
GO

USE QLNSTL
GO

CREATE TABLE NHANVIEN
(
	MANV VARCHAR(15),
	HOTEN NVARCHAR(128),
	DANTOC NVARCHAR(128),
	GIOITINH NVARCHAR(56),
	SODIENTHOAI VARCHAR(11),
	QUEQUAN NVARCHAR(256),
	NGAYSINH DATE,
	NGAYVAOLAM DATE,
	MAPB VARCHAR(15),
	MACV VARCHAR(15),
	TRINHDO NVARCHAR(56),
	PRIMARY KEY(MANV)
)

CREATE TABLE TAIKHOAN
(
	MATK INT IDENTITY(1,1),
	TENDANGNHAP VARCHAR(56) NOT NULL,
	MATKHAU VARCHAR(56) NOT NULL,
	TENNGUOIDUNG NVARCHAR(128) NOT NULL,
	TYPE INT NOT NULL,
	MANV VARCHAR(15)
	PRIMARY KEY(MATK)
)

CREATE TABLE BOIDUONG
(
	MABD INT IDENTITY(1,1),
	MANV VARCHAR(15),
	NOIBOIDUONG NVARCHAR(128) NOT NULL,
	THOIGIANDI DATE NOT NULL,
	THOIGIANKETTHUC DATE NOT NULL,
	PRIMARY KEY(MABD)
)

CREATE TABLE CHUCVU
(
	MACV VARCHAR(15),
	TENCV NVARCHAR(128) NOT NULL,
	PRIMARY KEY(MACV)
)

CREATE TABLE PHONGBAN
(
	MAPB VARCHAR(15),
	TENPB NVARCHAR(128),
	SODIENTHOAIPB VARCHAR(11),
	PRIMARY KEY(MAPB)
)

CREATE TABLE CHAMCONG
(
	MANV VARCHAR(15),
	NGAYLAMVIEC DATE,
	MATT VARCHAR(15),
	GHICHU NVARCHAR(128),
	PRIMARY KEY(MANV, NGAYLAMVIEC)
)

CREATE TABLE TINHTRANG
(
	MATT VARCHAR(15),
	TINHTRANG NVARCHAR(128),
	PRIMARY KEY(MATT)
)

CREATE TABLE TAMUNG
(
	MANV VARCHAR(15),
	NGAYTU DATE,
	SOTIENTU FLOAT,
	PRIMARY KEY(MANV, NGAYTU)
)

CREATE TABLE KHENTHUONG_KYLUAT
(
	MA INT IDENTITY,
	MANV VARCHAR(15),
	THOIGIAN DATE,
	HINHTHUC NVARCHAR(128),
	SOTIEN FLOAT,
	LYDO NVARCHAR(256),
	PRIMARY KEY(MA)
)

CREATE TABLE LUONGCANHAN
(
	MANV VARCHAR(15),
	LUONGCB FLOAT,
	HESO FLOAT,
	TIENPHUCAP FLOAT,
	PRIMARY KEY(MANV)
)

CREATE TABLE BAOHIEM
(
	MASOBH INT,
	TENBH NVARCHAR(128),
	MANV VARCHAR(15),
	NOICAP NVARCHAR(128),
	THOIGIAN DATE,
	SOTIENDONG FLOAT,
	PRIMARY KEY(MASOBH)
)
CREATE TABLE LUONGTHANG
(
	MANV VARCHAR(15),
	THANG INT,
	NAM INT,
	LUONGCB_LUCTINHLUONG FLOAT,
	HESO_LUCTINHLUONG FLOAT,
	TIENPHUCAP_LUCTINHLUONG FLOAT,
	SONGAYCONG INT,
	TIENBAOHIEM_LUCTINHLUONG FLOAT,
	TIENKHENTHUONG_LUCTINHLUONG FLOAT,
	TIENKYLUAT_LUCTINHLUONG FLOAT,
	TONGLUONG FLOAT,
	PRIMARY KEY(MANV,THANG,NAM)
)
GO

ALTER TABLE TAIKHOAN ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE BOIDUONG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MAPB) REFERENCES PHONGBAN(MAPB)
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MACV) REFERENCES CHUCVU(MACV)
ALTER TABLE CHAMCONG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE CHAMCONG ADD FOREIGN KEY(MATT) REFERENCES TINHTRANG(MATT)
ALTER TABLE TAMUNG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE KHENTHUONG_KYLUAT ADD CHECK (HINHTHUC=N'Khen thưởng' OR HINHTHUC=N'Kỷ luật') 
ALTER TABLE KHENTHUONG_KYLUAT ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE LUONGCANHAN ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE BAOHIEM ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE LUONGTHANG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
GO

INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP001', N'Marketing', '0486735694')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP002', N'Kế Toán', '0954824652')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP003', N'Kinh Doanh', '0546389752')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP004', N'Vật Tư', '0452361875')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP005', N'Quản Lý', '0453876218')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP006', N'Tiếp Tân', '0647215738')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP007', N'IT', '0246877999')
INSERT INTO PHONGBAN(MAPB,TENPB,SODIENTHOAIPB)
VALUES('MP008', N'Hành Chính', '0379512466')
GO

INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV001', N'Nhân Viên')
INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV002', N'Lái Xe')
INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV003', N'Quản Lý Nhân Viên')
INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV004', N'Bảo Vệ')
INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV005', N'Chủ Quản Phòng Ban')
INSERT INTO CHUCVU(MACV,TENCV)
VALUES('CV006', N'Giám Đốc')
GO

INSERT INTO TAIKHOAN(TENNGUOIDUNG,TENDANGNHAP,MATKHAU,TYPE)
VALUES(N'Giám Đốc', 'Admin', 'Admin', 0)
INSERT INTO TAIKHOAN(TENNGUOIDUNG,TENDANGNHAP,MATKHAU,TYPE)
VALUES(N'Quản Lý Nhân Sự', 'QLNS', 'QLNS', 1)
INSERT INTO TAIKHOAN(TENNGUOIDUNG,TENDANGNHAP,MATKHAU,TYPE)
VALUES(N'Quản Lý Tiền Lương', 'QLTL', 'QLTL', 2)
GO

INSERT INTO TINHTRANG(MATT,TINHTRANG)
VALUES ('DL', N'Đi làm')
INSERT INTO TINHTRANG(MATT,TINHTRANG)
VALUES ('NCP', N'Nghĩ có phép')
INSERT INTO TINHTRANG(MATT,TINHTRANG)
VALUES ('NKP', N'Nghĩ không phép')
GO

INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV001', N'Đặng Công Danh', N'Nam', N'Kinh', '8-11-1990','4-15-2015', N'Bình Phước', '0285160935', 'MP001', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV002', N'Chu Thành Trung', N'Nam', N'Kinh', '8-11-1990','4-15-2015', N'Cà Mau', '028516458', 'MP004', 'CV002', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV003', N'Nguyễn Văn Dũng', N'Nam', N'Kinh', '8-11-1990','4-15-2015', N'Thanh Hóa', '0285134893', 'MP006', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV004', N'Đào Thị Cúc', N'Nữ', N'Kinh', '8-11-1990','4-15-2015', N'Bình Phước', '0652160935', 'MP008', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV005', N'Nguyễn Văn Viễn', N'Nam', N'Kinh', '3-1-1987','4-15-2015', N'Quảng Ngải', '0284250935', 'MP003', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV006', N'Đào Minh Tuyết', N'Nữ', N'Kinh', '6-7-1995','4-15-2015', N'Bình Dương', '0285345635', 'MP006', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV007', N'Nguyễn Tấn Lợi', N'Nam', N'Kinh', '4-5-1985','4-15-2015', N'Bình Phước', '0275412935', 'MP007', 'CV005', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV008', N'Lê Anh Tuấn', N'Nam', N'Kinh', '3-25-1994','4-15-2015', N'Bình Phước', '0285175485', 'MP007', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV009', N'Lê Thị Như Quỳnh', N'Nữ', N'Kinh', '10-7-1992','4-15-2015', N'Bình Đình', '0283480935', 'MP002', 'CV005', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV010', N'Nguyễn Văn Toàn', N'Nam', N'Kinh', '6-14-1988','4-15-2015', N'Hà Giang', '0269550935', 'MP005', 'CV003', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV011', N'Trần Hoàng My', N'Nữ', N'Kinh', '11-11-1990','4-15-2015', N'Sóc Trăng', '0285754235', 'MP008', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV012', N'Lê Văn Hiệp', N'Nam', N'Kinh', '4-6-1988','4-15-2015', N'Đà Lạt', '0285167524', 'MP004', 'CV003', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV013', N'Nguyễn Tấn Thành', N'Nam', N'Kinh', '7-10-1991','4-15-2015', N'Bình Dương', '0248160935', 'MP006', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV014', N'Trần Công Tâm', N'Nam', N'Kinh', '8-11-1989','4-15-2015', N'Bình Phước', '0285864935', 'MP001', 'CV001', N'Đại Học')
INSERT INTO NHANVIEN(MANV,HOTEN,GIOITINH,DANTOC,NGAYSINH, NGAYVAOLAM,QUEQUAN,SODIENTHOAI,MAPB,MACV,TRINHDO)
VALUES('NV015', N'Mai Văn Nga', N'Nữ', N'Kinh', '4-29-1989','4-15-2015', N'Hà Nội', '024628935', 'MP001', 'CV001', N'Đại Học')
GO

INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV001', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV002', 4500000, 1, 300000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV003', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV004', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV005', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV006', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV007', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV008', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV009', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV010', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV011', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV012', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV013', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV014', 4500000, 2, 200000)
INSERT INTO LUONGCANHAN(MANV,LUONGCB,HESO,TIENPHUCAP)
VALUES ('NV015', 4500000, 2, 200000)
GO


INSERT INTO BOIDUONG(MANV,NOIBOIDUONG,THOIGIANDI,THOIGIANKETTHUC)
VALUES ('NV001', N'Tổng Công Ty Bên Mỹ', '7-24-2017', '12-25-2017')
INSERT INTO BOIDUONG(MANV,NOIBOIDUONG,THOIGIANDI,THOIGIANKETTHUC)
VALUES ('NV002', N'Tổng Công Ty Bên Mỹ', '7-24-2017', '12-25-2017')
INSERT INTO BOIDUONG(MANV,NOIBOIDUONG,THOIGIANDI,THOIGIANKETTHUC)
VALUES ('NV003', N'Tổng Công Ty Bên Mỹ', '7-24-2017', '12-25-2017')
INSERT INTO BOIDUONG(MANV,NOIBOIDUONG,THOIGIANDI,THOIGIANKETTHUC)
VALUES ('NV004', N'Tổng Công Ty Bên Mỹ', '7-24-2017', '12-25-2017')
INSERT INTO BOIDUONG(MANV,NOIBOIDUONG,THOIGIANDI,THOIGIANKETTHUC)
VALUES ('NV005', N'Tổng Công Ty Bên Mỹ', '7-24-2017', '12-25-2017')
GO

INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV001','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV002','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV003','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV004','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV005','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV006','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV007','1-31-2018','DL')
INSERT INTO CHAMCONG(MANV,NGAYLAMVIEC,MATT)
VALUES ('NV008','1-31-2018','DL')
GO

INSERT INTO TAMUNG(MANV, NGAYTU, SOTIENTU)
VALUES ('NV001','1-25-2018', 50000)
INSERT INTO TAMUNG(MANV, NGAYTU, SOTIENTU)
VALUES ('NV002','1-25-2018', 30000)
INSERT INTO TAMUNG(MANV, NGAYTU, SOTIENTU)
VALUES ('NV003','1-25-2018', 40000)
INSERT INTO TAMUNG(MANV, NGAYTU, SOTIENTU)
VALUES ('NV007','1-25-2018', 30000)
INSERT INTO TAMUNG(MANV, NGAYTU, SOTIENTU)
VALUES ('NV008','1-25-2018', 40000)
GO

INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV001', N'Khen thưởng', 50000, '1-25-2018', N'Tăng ca 2 tiếng')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV002', N'Khen thưởng', 50000, '1-25-2018', N'Tăng ca 2 tiếng')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV003', N'Khen thưởng', 50000, '1-25-2018', N'Tăng ca 2 tiếng')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV001', N'Kỷ luật', 3000, '1-15-2018', N'Đi trễ')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV002', N'Kỷ luật', 3000, '1-15-2018', N'Đi trễ')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV003', N'Kỷ luật', 3000, '1-15-2018', N'Đi trễ')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV001', N'Kỷ luật', 30000, '1-18-2018', N'Đi trễ')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV002', N'Kỷ luật', 30000, '1-18-2018', N'Đi trễ')
INSERT INTO KHENTHUONG_KYLUAT(MANV,HINHTHUC,SOTIEN,THOIGIAN,LYDO)
VALUES ('NV003', N'Kỷ luật', 30000, '1-18-2018', N'Đi trễ')
GO

INSERT INTO BAOHIEM(MASOBH,MANV,TENBH,NOICAP,THOIGIAN,SOTIENDONG)
VALUES (1024563582, 'NV001', N'Bảo hiểm y tế', N'Bình Dương', '1-1-2018', 300000)
INSERT INTO BAOHIEM(MASOBH,MANV,TENBH,NOICAP,THOIGIAN,SOTIENDONG)
VALUES (1024563545, 'NV001', N'Bảo hiểm xã hội', N'Bình Dương', '1-1-2018', 800000)
INSERT INTO BAOHIEM(MASOBH,MANV,TENBH,NOICAP,THOIGIAN,SOTIENDONG)
VALUES (1765582145, 'NV002', N'Bảo hiểm xã hội', N'Bình Dương', '1-1-2018', 500000)
GO